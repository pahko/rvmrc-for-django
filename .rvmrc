go_to=$(pwd) # directory opened

while [ ! -e ".rvmrc" ]; do
    cd ..
done

if [ -f bin/activate ]; then
    source bin/activate
else
    if type -P virtualenv &> /dev/null; then
        virtualenv . --no-site-packages
    elif type -P virtualenv2 &> /dev/null; then
        virtualenv2 .
    else
        echo "Please install virtualenv"
        return
    fi
    source bin/activate
    manage_file=$(find | grep manage.py)
    directory=${manage_file%manage.py}
    pip install -r "${directory}requirements.txt"
fi

cd $go_to # go to initial destination directory